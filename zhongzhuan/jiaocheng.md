
## 系统要求
Centos / Debian / Ubuntu 14.04 +

推荐 Debian / Ubuntu，这个是我一直使用的系统，我的脚本在这个系统上面出错率最低。

## 安装步骤
wget -N --no-check-certificate https://raw.githubusercontent.com/zwz1018/zwz1018/master/zhongzhuan/zhongzhuan.sh && chmod +x zhongzhuan.sh && bash zhongzhuan.sh

### 运行脚本后，会显示菜单：

 iptables 端口转发一键管理脚本 [vx.x.x]
 -- Toyo | doub.io/wlzy-20 --
 
 0. 升级脚本
————————————
 1. 安装 iptables
 2. 清空 iptables 端口转发
————————————
 3. 查看 iptables 端口转发
 4. 添加 iptables 端口转发
 5. 删除 iptables 端口转发
————————————
注意：初次使用前请请务必执行 1. 安装 iptables(不仅仅是安装)
 
 请输入数字 [0-5]:
## 选择 4. 添加 iptables 端口转发 后，会提示你依次输入 欲转发IP、欲转发端口、本地监听端口、本地IP、转发类型：

请输入 iptables 欲转发至的 远程端口 [1-65535] (支持端口段 如 2333-6666, 被转发服务器):10000-11000
 
 欲转发端口 : 10000-11000
 
请输入 iptables 欲转发至的 远程IP(被转发服务器):2.2.2.2
 
 欲转发服务器IP : 2.2.2.2
 
请输入 iptables 本地监听端口 [1-65535] (支持端口段 如 2333-6666)
(默认端口: 10000-11000):
 
 本地监听端口 : 10000-11000
 
请输入 本服务器的 公网IP网卡IP(注意是网卡绑定的IP，而不仅仅是公网IP，回车自动检测):
 
 本服务器IP : 1.1.1.1
 
请输入数字 来选择 iptables 转发类型:
 1. TCP
 2. UDP
 3. TCP+UDP
 
(默认: TCP+UDP):
 
——————————————————————————————
 请检查 iptables 端口转发规则配置是否有误 !
 
 本地监听端口 : 10000-11000
 服务器 IP : 2.2.2.2
 
 欲转发的端口 : 10000-11000
 欲转发 IP : 1.1.1.1
 转发类型 : TCP+UDP
——————————————————————————————
### 最后会提示你确认配置是否有误，如果没有问题就按任意键继续，启动成功后就会提示：

——————————————————————————————
 iptables 端口转发规则配置完成 !
 
 本地监听端口 : 10000:11000
 服务器 IP : 1.1.1.1
 
 欲转发的端口 : 10000:11000
 欲转发 IP : 2.2.2.2
 转发类型 : TCP+UDP
——————————————————————————————
### 选择 3. 查看 iptables 端口转发 后，会显示如下：

当前有 2 个 iptables 端口转发规则。
1. 类型: tcp 监听端口: 10000:20000 转发IP和端口: 2.2.2.2:10000-20000
2. 类型: udp 监听端口: 10000:20000 转发IP和端口: 2.2.2.2:10000-20000
选择 5. 删除 iptables 端口转发 后，也会显示列表，然后让你选择 要删除的端口转发规则序号。

## Shadowsocks v2ray客户端说明
假设你的海外服务器(被中转)中搭建的Shadowsocks服务端的IP是 2.2.2.2  ，SS端口是 10000 。

假设中转服务器的IP是 1.1.1.1 ，本地监听端口和SS端口不一致，本地监听端口是 20000 。

那么，你的Shadowsocks客户端，添加Shadowsocks服务器，IP填写 1.1.1.1（公网ip) ，端口填写 20000 ，其他的 密码/加密方式/协议/混淆等等 全部和原Shadowsocks账号一样！

### 其他说明
CentOS 7 默认的防火墙是 firewall，要使用本脚本，请先卸载或关闭 firewall 服务器，并安装 iptables 全套软件。

### 关于国内腾讯云等服务器转发失败解释
国内的很多服务器，例如腾讯云，在VPS网卡上面绑定的都是内网IP，这样的话，如果你用脚本自动检测外网IP，会转发失败，需要在添加转发规则的时候，本服务器IP手动写你的服务器 网卡上面绑定的IP。

ifconfig
 输入命令后会看到 网卡信息，我们看第二行的 inet addr:xxx.xxx.xxx.xxx ，这里的 xxx 就是你的网卡绑定的IP。
 
 ### 提示wget: unknown host “raw.githubusercontent.com” 之类的错误
这是无法解析我的域名，多半是DNS的问题，请更换DNS为谷歌DNS。

### 提示 wget: command not found 的错误
这是你的系统精简的太干净了，wget都没有安装，所以需要安装wget。


### 更换 apt源，解决安装错误：[错误] iptables安装失败 等等
一些VPS的 apt源太老旧，导致无法安装或升级iptables，所以我这里写上如何更换 apt源。所以我只针对这两个系统，Centos的自己去谷歌yum镜像源。
